/// <reference types="adal" />
import { ServiceKey, ServiceScope } from '@microsoft/sp-core-library';
/**
 * Represents the exported module from the adal-angular npm package.
 */
export interface IAdalJsModule {
    inject: (configuration: adal.Config) => adal.AuthenticationContext;
}
/**
 * This class allows a developer to obtain OAuth2 tokens.
 *
 * OAuth2 tokens are used to authenticate the user from the SharePoint page
 * to other services such as PowerBI, Sway, Exchange, Yammer, etc.
 *
 * @remarks
 * OAuth2TokenProvider is replacing the /_api.SP.OAuth.Token/Acquire endpoint
 * for authentication with ADAL.js. At some point in the near future, when Azure AD v2.0
 * can support the same scenarios as the original version, we will switch to MSAL.
 *
 * @alpha
 */
export default class OAuth2TokenProvider {
    /**
     * The service key for OAuth2TokenProvider.
     */
    static readonly serviceKey: ServiceKey<OAuth2TokenProvider>;
    protected static _authContext: adal.AuthenticationContext;
    protected _displayCallHandler: ((args: IDisplayCallHandlerArgs) => void) | undefined;
    protected _loadAndConfigureAdalJsModulePromise: Promise<IAdalJsModule> | undefined;
    private _azureInstanceUrl;
    private _azureTenantId;
    private _isInitialized;
    private _loginUserPromise;
    constructor(serviceScope: ServiceScope);
    /**
     * The initialize function should be called before the application/components
     * have a chance to make a OAuth2TokenProvider request.
     * @internal
     */
    _initialize(azureInstanceUrl: string, azureTenantId: string): void;
    /**
     * Fetches the oauth token for a resource if the user that's currently logged in has
     * access to that resource.
     *
     * The OAuth token SHOULD NOT be cached by the caller since it is already cached by the method
     * itself.
     *
     * An example of a resourceEndpoint would be https://sdfpilot.outlook.com
     *
     * @param resourceEndpoint - the resource for which the token should be obtained
     * @returns A promise that will be fullfiled with the token or that will reject
     *          with an error message
     */
    getOAuthToken(resourceEndpoint: string): Promise<string>;
    private _acquireTokenPromise(resourceEndpoint);
    private _acquireTokenPopupPromise(resourceEndpoint);
    private _loadAndConfigureAdalJsModule();
    private _configureAdalJs(adalJsModule);
    /**
     * Calls _authContext.login() and wires up the displayCall callback.  Returns true if the
     * callback was called.
     */
    private _startLogin(showWindowCallback);
    private _loginUser();
    private _waitForWindowToClose(popupWindow, args);
}
export interface IDisplayCallHandlerArgs {
    urlNavigate: string;
    redirectUri: string;
}
